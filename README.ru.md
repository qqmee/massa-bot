# Massa –ø–∞—É–∫–∞–Ω

üá∫üá∏ [English](./README.ru) | üá∑üá∫ –†—É—Å—Å–∫–∏–π

–ò—Å—Ö–æ–¥–Ω–∏–∫–∏ —Ç–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç–∞ https://t.me/hekumatiarubot –¥–ª—è [Massa](https://massa.net/)

- –≤—ã–¥–∞–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã–µ –ª–æ–∫–∞—Ü–∏–∏ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–æ–¥—ã
- –ø–æ–∏—Å–∫ –Ω–æ–¥ –ø–æ IP
- –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ–¥–∞–∂–∞—Ö —Ä–æ–ª–ª–æ–≤

**–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ**

- [–ß—Ç–æ –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º](#—á—Ç–æ-–ø–æ–¥-–∫–∞–ø–æ—Ç–æ–º)
- [–ö–æ–º–∞–Ω–¥—ã](#–∫–æ–º–∞–Ω–¥—ã)
- [–°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è](#—Å–∏—Å—Ç–µ–º–Ω—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ (—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)](#—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)
- [–ù–∞—Å—Ç—Ä–æ–π–∫–∞](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
- [–ó–µ—Ä–∫–∞–ª–∞](#–∑–µ—Ä–∫–∞–ª–∞)

## –ß—Ç–æ –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º

- [NestJS](https://nestjs.com/) - Node.js —Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- [grammY](https://github.com/grammyjs/grammY) - Telegram Bot —Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- [Fluent](https://projectfluent.org/) - —Å–∏—Å—Ç–µ–º–∞ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ / —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —Ä–∞–∑–º–µ—Ç–∫–∏
- [TypeORM](https://typeorm.io/) (MySQL) - ORM
- [Docker](https://www.docker.com/)

## –ö–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞    | –û–ø–∏—Å–∞–Ω–∏–µ                       | –ü—Ä–∏–º–µ—Ä            |
| ---------- | ------------------------------ | ----------------- |
| /start     | –û—Å–Ω–æ–≤–Ω–æ–µ –º–µ–Ω—é                  |                   |
| /help      | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥             |                   |
| /hosting   | –ü—Ä–æ–º–æ–∫–æ–¥—ã                      |                   |
| /add       | –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–¥—É                  | `/add abcdef tag` |
| /delete    | –£–¥–∞–ª–∏—Ç—å –Ω–æ–¥—É                   | `/delete abcdef`  |
| /ip        | –ü–æ–∏—Å–∫ –ø–æ –º–∞—Å–∫–µ IP              | `/ip 65`          |
| /community | –°—Å—ã–ª–∫–∏ –Ω–∞ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞           |                   |
| /free      | –°—Ç—Ä–∞–Ω—ã –±–µ–∑ –Ω–æ–¥                 |                   |
| /company   | –•–æ—Å—Ç–∏–Ω–≥ –∫–æ–º–ø–∞–Ω–∏–∏ —Å –∫–æ–ª-–≤–æ–º –Ω–æ–¥ |                   |
| /country   | –°—Ç—Ä–∞–Ω—ã —Å –Ω–æ–¥–∞–º–∏                |                   |
| /version   | –ü–æ –≤–µ—Ä—Å–∏—è–º                     |                   |
| /stats     | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ—Ç–∏                |                   |
| /release   | –ü–æ–ª—É—á–∏—Ç—å –±–∏–Ω–∞—Ä–Ω–∏–∫–∏ —Å GitHub    |                   |
| /mirror    | –ó–µ—Ä–∫–∞–ª–∞                        |                   |
| /en        | üá∫üá∏ English language            |                   |
| /ru        | üá∑üá∫ –†—É—Å—Å–∫–∏–π —è–∑—ã–∫                |                   |
| /whoami    | ID –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏                 |                   |

## –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

| Hardware | Value                      |
| -------- | -------------------------- |
| CPU      | 2 core                     |
| RAM      | 1 Gb                       |
| Storage  | 1.2 Gb (images & database) |

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

–ù—É–∂–µ–Ω [Docker](https://docs.docker.com/desktop/install/linux-install/).
–í –∫–æ—Ä–Ω–µ —Ä–µ–ø—ã –ª–µ–∂–∏—Ç –≥–æ—Ç–æ–≤—ã–π `docker-compose.yml`. –ß—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã –Ω–∏–∂–µ

```
curl -sSL https://raw.githubusercontent.com/qqmee/massa-telegram-bot/main/docker-compose.yml > docker-compose.yml
mkdir -p .data/hek-db/{lib,log}
```

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è self-signed —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç https://core.telegram.org/bots/self-signed
–°–≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –µ–≥–æ –∫–æ–º–∞–Ω–¥–æ–π, –Ω–æ —Å–Ω–∞—á–∞–ª–∞ –∑–∞–º–µ–Ω–∏ `IP_–∞–¥—Ä–µ—Å`

```
openssl req -newkey rsa:2048 -sha256 -nodes -keyout .data/private.key -x509 -days 3650 -out .data/public.pem -subj "/C=US/ST=New York/L=Brooklyn/O=Example Brooklyn Company/CN=IP_–∞–¥—Ä–µ—Å"

# –¥–ª—è private.key —á—Ç–µ–Ω–∏–µ –Ω–µ –æ–∫, –Ω–æ —Å–µ–≥–æ–¥–Ω—è —Ä–∞–∑—Ä–µ—à–∞—é
chmod 444 .data/{private.key,public.pem}
```

–ó–∞–ø—É—Å–∫

```
# WARN: –ø–µ—Ä–µ–¥ —Ç–µ–º, –∫–∞–∫ –∑–∞–ø—É—Å–∫–∞—Ç—å - –∏–∑–º–µ–Ω–∏ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞ —Å–≤–æ–∏. –ù–∏–∂–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è - –∑–∞—Ç–µ–º —Å–ª–µ–¥—É—é—â–∞—è –∫–æ–º–∞–Ω–¥–∞
## docker compose up -d
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–£—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É—è —Ñ–∞–π–ª `docker-compose.yml`

| Env            | Scope          | –ü—Ä–∏–º–µ—Ä                                              | –û–ø–∏—Å–∞–Ω–∏–µ                                      |
| -------------- | -------------- | --------------------------------------------------- | --------------------------------------------- |
| MYSQL_HOST     | db,bot,cron    | massa                                               |                                               |
| MYSQL_PORT     | db,bot,cron    | 3306                                                |                                               |
| MYSQL_USER     | db,bot,cron    | massa                                               |                                               |
| MYSQL_PASSWORD | db,bot,cron    | bVrsy                                               |                                               |
| MYSQL_DATABASE | db,bot,cron    | massa                                               |                                               |
| REDIS_HOST     | redis,bot,cron | redis                                               |                                               |
| REDIS_PORT     | redis,bot,cron | 6379                                                |                                               |
| REDIS_PASSWORD | redis,bot,cron | guest                                               |                                               |
| MASSA_RPC      | bot            | https://buildnet.massa.net/api/v2,198.27.74.5:33035 | api endpoint, —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é                   |
| GEOIP_RPC      | bot,cron       | http://127.0.0.1:3050                               | api endpoint                                  |
| BOTS           | bot,cron       | 1:PPrreevvee,32:DDMMeeDDVveEdd                      | –∫–ª—é—á–∏ –æ—Ç [@BotFather](https://t.me/BotFather) |
| BOT_ADMINS     | bot,cron       | 1,2                                                 | –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ –ª–æ–∫–∞—Ö –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞             |
| PORT           | bot            | 3000                                                | webhook port                                  |
| WEBHOOK_URL    | bot            | https://abcdef.loca.lt                              | webhook domain                                |

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```
git clone https://github.com/qqmee/massa-bot
cd massa-bot

# —Å–Ω–∞—á–∞–ª–∞ –∏–∑–º–µ–Ω–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ .env —Ñ–∞–π–ª–∞ –Ω–∞ —Å–≤–æ–∏
cp .env.example .env

# –∑–∞–ø—É—Å–∫ –±–¥
## docker compose up -d db redis

# —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm i

# –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã —Ç–∞–±–ª–∏—Ü—ã –≤ –±–¥ (–∏–ª–∏ –¥—Ä–æ–ø–Ω—É—Ç—ã)
npm run dev

# –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ: –∑–∞–ø—É—Å–∫ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ –∑–∞–¥–∞—á
npm run dev::cron

# –∑–∞–ø—É—Å–∫ https tunnel –∏—Å–ø–æ–ª—å–∑—É—è –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Å—ã—Ä, —á—Ç–æ–±—ã –Ω–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å ssl —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (–∑–∞–º–µ–Ω–∏ 'abcdef' –Ω–∞ —Å–≤–æ–π —Å–∞–±–¥–æ–º–µ–Ω)
npx localtunnel --port 3000 --subdomain abcdef # –≤—ã–¥–∞—Å—Ç —Ç–∞–∫–æ–π: https://abcdef.loca.lt
```

## –ó–µ—Ä–∫–∞–ª–∞

[–¢—É—Ç](./static/mirrors.txt)
